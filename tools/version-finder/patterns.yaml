# Patterns of files to search in
files:
  - arch/*
  - drivers/net/*
  - drivers/media/*
  - include/*
  - kernel/bpf/*
  - kernel/trace/*
  - kernel/events/*
  - net/*
  - security/*

# Patterns of tags to check
tags:
  - ^v3.15$
  - ^v3.16$
  - ^v3.17$
  - ^v3.18$
  - ^v3.19$
  - ^v[4-9].[0-9]+$

# The text patterns for which to record the first tag to match
patterns:
  - name: program_types
    patterns:
    - name: BPF_PROG_TYPE_SOCKET_FILTER
      # regexes: ["BPF_PROG_TYPE_SOCKET_FILTER"]
    - name: BPF_PROG_TYPE_KPROBE
    - name: BPF_PROG_TYPE_SCHED_CLS
    - name: BPF_PROG_TYPE_SCHED_ACT
    - name: BPF_PROG_TYPE_TRACEPOINT
    - name: BPF_PROG_TYPE_XDP
    - name: BPF_PROG_TYPE_PERF_EVENT
    - name: BPF_PROG_TYPE_CGROUP_SKB
    - name: BPF_PROG_TYPE_CGROUP_SOCK
    - name: BPF_PROG_TYPE_LWT_IN
    - name: BPF_PROG_TYPE_LWT_OUT
    - name: BPF_PROG_TYPE_LWT_XMIT
    - name: BPF_PROG_TYPE_SOCK_OPS
    - name: BPF_PROG_TYPE_SK_SKB
    - name: BPF_PROG_TYPE_CGROUP_DEVICE
    - name: BPF_PROG_TYPE_SK_MSG
    - name: BPF_PROG_TYPE_RAW_TRACEPOINT
    - name: BPF_PROG_TYPE_CGROUP_SOCK_ADDR
    - name: BPF_PROG_TYPE_LWT_SEG6LOCAL
    - name: BPF_PROG_TYPE_LIRC_MODE2
    - name: BPF_PROG_TYPE_SK_REUSEPORT
    - name: BPF_PROG_TYPE_FLOW_DISSECTOR
    - name: BPF_PROG_TYPE_CGROUP_SYSCTL
    - name: BPF_PROG_TYPE_RAW_TRACEPOINT_WRITABLE
    - name: BPF_PROG_TYPE_CGROUP_SOCKOPT
    - name: BPF_PROG_TYPE_TRACING
    - name: BPF_PROG_TYPE_STRUCT_OPS
    - name: BPF_PROG_TYPE_EXT
    - name: BPF_PROG_TYPE_LSM
    - name: BPF_PROG_TYPE_SK_LOOKUP
    - name: BPF_PROG_TYPE_SYSCALL

  - name: map_types
    patterns:
    - name: BPF_MAP_TYPE_HASH
    - name: BPF_MAP_TYPE_ARRAY
    - name: BPF_MAP_TYPE_PROG_ARRAY
    - name: BPF_MAP_TYPE_PERF_EVENT_ARRAY
    - name: BPF_MAP_TYPE_PERCPU_HASH
    - name: BPF_MAP_TYPE_PERCPU_ARRAY
    - name: BPF_MAP_TYPE_STACK_TRACE
    - name: BPF_MAP_TYPE_CGROUP_ARRAY
    - name: BPF_MAP_TYPE_LRU_HASH
    - name: BPF_MAP_TYPE_LRU_PERCPU_HASH
    - name: BPF_MAP_TYPE_LPM_TRIE
    - name: BPF_MAP_TYPE_ARRAY_OF_MAPS
    - name: BPF_MAP_TYPE_HASH_OF_MAPS
    - name: BPF_MAP_TYPE_DEVMAP
    - name: BPF_MAP_TYPE_SOCKMAP
    - name: BPF_MAP_TYPE_CPUMAP
    - name: BPF_MAP_TYPE_XSKMAP
    - name: BPF_MAP_TYPE_SOCKHASH
    - name: BPF_MAP_TYPE_CGROUP_STORAGE
    - name: BPF_MAP_TYPE_REUSEPORT_SOCKARRAY
    - name: BPF_MAP_TYPE_PERCPU_CGROUP_STORAGE
    - name: BPF_MAP_TYPE_QUEUE
    - name: BPF_MAP_TYPE_STACK
    - name: BPF_MAP_TYPE_SK_STORAGE
    - name: BPF_MAP_TYPE_DEVMAP_HASH
    - name: BPF_MAP_TYPE_STRUCT_OPS
    - name: BPF_MAP_TYPE_RINGBUF
    - name: BPF_MAP_TYPE_INODE_STORAGE
    - name: BPF_MAP_TYPE_TASK_STORAGE
    - name: BPF_MAP_TYPE_BLOOM_FILTER

  - name: attach_types
    patterns:
    - name: BPF_CGROUP_INET_INGRESS
    - name: BPF_CGROUP_INET_EGRESS
    - name: BPF_CGROUP_INET_SOCK_CREATE
    - name: BPF_CGROUP_SOCK_OPS
    - name: BPF_SK_SKB_STREAM_PARSER
    - name: BPF_SK_SKB_STREAM_VERDICT
    - name: BPF_CGROUP_DEVICE
    - name: BPF_SK_MSG_VERDICT
    - name: BPF_CGROUP_INET4_BIND
    - name: BPF_CGROUP_INET6_BIND
    - name: BPF_CGROUP_INET4_CONNECT
    - name: BPF_CGROUP_INET6_CONNECT
    - name: BPF_CGROUP_INET4_POST_BIND
    - name: BPF_CGROUP_INET6_POST_BIND
    - name: BPF_CGROUP_UDP4_SENDMSG
    - name: BPF_CGROUP_UDP6_SENDMSG
    - name: BPF_LIRC_MODE2
    - name: BPF_FLOW_DISSECTOR
    - name: BPF_CGROUP_SYSCTL
    - name: BPF_CGROUP_UDP4_RECVMSG
    - name: BPF_CGROUP_UDP6_RECVMSG
    - name: BPF_CGROUP_GETSOCKOPT
    - name: BPF_CGROUP_SETSOCKOPT
    - name: BPF_TRACE_RAW_TP
    - name: BPF_TRACE_FENTRY
    - name: BPF_TRACE_FEXIT
    - name: BPF_MODIFY_RETURN
    - name: BPF_LSM_MAC
    - name: BPF_TRACE_ITER
    - name: BPF_CGROUP_INET4_GETPEERNAME
    - name: BPF_CGROUP_INET6_GETPEERNAME
    - name: BPF_CGROUP_INET4_GETSOCKNAME
    - name: BPF_CGROUP_INET6_GETSOCKNAME
    - name: BPF_XDP_DEVMAP
    - name: BPF_CGROUP_INET_SOCK_RELEASE
    - name: BPF_XDP_CPUMAP
    - name: BPF_SK_LOOKUP
    - name: BPF_XDP
    - name: BPF_SK_SKB_VERDICT
    - name: BPF_SK_REUSEPORT_SELECT
    - name: BPF_SK_REUSEPORT_SELECT_OR_MIGRATE
    - name: BPF_PERF_EVENT
    - name: BPF_TRACE_KPROBE_MULTI

  - name: syscall_commands
    patterns:
    - name: BPF_MAP_CREATE
    - name: BPF_MAP_LOOKUP_ELEM
    - name: BPF_MAP_UPDATE_ELEM
    - name: BPF_MAP_DELETE_ELEM
    - name: BPF_MAP_GET_NEXT_KEY
    - name: BPF_PROG_LOAD
    - name: BPF_OBJ_PIN
    - name: BPF_OBJ_GET
    - name: BPF_PROG_ATTACH
    - name: BPF_PROG_DETACH
    - name: BPF_PROG_TEST_RUN
    - name: BPF_PROG_GET_NEXT_ID
    - name: BPF_MAP_GET_NEXT_ID
    - name: BPF_PROG_GET_FD_BY_ID
    - name: BPF_MAP_GET_FD_BY_ID
    - name: BPF_OBJ_GET_INFO_BY_FD
    - name: BPF_PROG_QUERY
    - name: BPF_RAW_TRACEPOINT_OPEN
    - name: BPF_BTF_LOAD
    - name: BPF_BTF_GET_FD_BY_ID
    - name: BPF_TASK_FD_QUERY
    - name: BPF_MAP_LOOKUP_AND_DELETE_ELEM
    - name: BPF_MAP_FREEZE
    - name: BPF_BTF_GET_NEXT_ID
    - name: BPF_MAP_LOOKUP_BATCH
    - name: BPF_MAP_LOOKUP_AND_DELETE_BATCH
    - name: BPF_MAP_UPDATE_BATCH
    - name: BPF_MAP_DELETE_BATCH
    - name: BPF_LINK_CREATE
    - name: BPF_LINK_UPDATE
    - name: BPF_LINK_GET_FD_BY_ID
    - name: BPF_LINK_GET_NEXT_ID
    - name: BPF_ENABLE_STATS
    - name: BPF_ITER_CREATE
    - name: BPF_LINK_DETACH
    - name: BPF_PROG_BIND_MAP

  - name: link_type
    patterns:
    - name: BPF_LINK_TYPE_RAW_TRACEPOINT
    - name: BPF_LINK_TYPE_TRACING
    - name: BPF_LINK_TYPE_CGROUP
    - name: BPF_LINK_TYPE_ITER
    - name: BPF_LINK_TYPE_NETNS
    - name: BPF_LINK_TYPE_XDP
    - name: BPF_LINK_TYPE_PERF_EVENT
    - name: BPF_LINK_TYPE_KPROBE_MULTI

  - name: helpers
    patterns:
    - name: bpf_map_lookup_elem
    - name: bpf_map_update_elem
    - name: bpf_map_delete_elem
    - name: bpf_probe_read
    - name: bpf_ktime_get_ns
    - name: bpf_trace_printk
    - name: bpf_get_prandom_u32
    - name: bpf_get_smp_processor_id
    - name: bpf_skb_store_bytes
    - name: bpf_l3_csum_replace
    - name: bpf_l4_csum_replace
    - name: bpf_tail_call
    - name: bpf_clone_redirect
    - name: bpf_get_current_pid_tgid
    - name: bpf_get_current_uid_gid
    - name: bpf_get_current_comm
    - name: bpf_get_cgroup_classid
    - name: bpf_skb_vlan_push
    - name: bpf_skb_vlan_pop
    - name: bpf_skb_get_tunnel_key
    - name: bpf_skb_set_tunnel_key
    - name: bpf_perf_event_read
    - name: bpf_redirect
    - name: bpf_get_route_realm
    - name: bpf_perf_event_output
    - name: bpf_skb_load_bytes
    - name: bpf_get_stackid
    - name: bpf_csum_diff
    - name: bpf_skb_get_tunnel_opt
    - name: bpf_skb_set_tunnel_opt
    - name: bpf_skb_change_proto
    - name: bpf_skb_change_type
    - name: bpf_skb_under_cgroup
    - name: bpf_get_hash_recalc
    - name: bpf_get_current_task
    - name: bpf_probe_write_user
    - name: bpf_current_task_under_cgroup
    - name: bpf_skb_change_tail
    - name: bpf_skb_pull_data
    - name: bpf_csum_update
    - name: bpf_set_hash_invalid
    - name: bpf_get_numa_node_id
    - name: bpf_skb_change_head
    - name: bpf_xdp_adjust_head
    - name: bpf_probe_read_str
    - name: bpf_get_socket_cookie
    - name: bpf_get_socket_uid
    - name: bpf_set_hash
    - name: bpf_setsockopt
    - name: bpf_skb_adjust_room
    - name: bpf_redirect_map
    - name: bpf_sk_redirect_map
    - name: bpf_sock_map_update
    - name: bpf_xdp_adjust_meta
    - name: bpf_perf_event_read_value
    - name: bpf_perf_prog_read_value
    - name: bpf_getsockopt
    - name: bpf_override_return
    - name: bpf_sock_ops_cb_flags_set
    - name: bpf_msg_redirect_map
    - name: bpf_msg_apply_bytes
    - name: bpf_msg_cork_bytes
    - name: bpf_msg_pull_data
    - name: bpf_bind
    - name: bpf_xdp_adjust_tail
    - name: bpf_skb_get_xfrm_state
    - name: bpf_get_stack
    - name: bpf_skb_load_bytes_relative
    - name: bpf_fib_lookup
    - name: bpf_sock_hash_update
    - name: bpf_msg_redirect_hash
    - name: bpf_sk_redirect_hash
    - name: bpf_lwt_push_encap
    - name: bpf_lwt_seg6_store_bytes
    - name: bpf_lwt_seg6_adjust_srh
    - name: bpf_lwt_seg6_action
    - name: bpf_rc_repeat
    - name: bpf_rc_keydown
    - name: bpf_skb_cgroup_id
    - name: bpf_get_current_cgroup_id
    - name: bpf_get_local_storage
    - name: bpf_sk_select_reuseport
    - name: bpf_skb_ancestor_cgroup_id
    - name: bpf_sk_lookup_tcp
    - name: bpf_sk_lookup_udp
    - name: bpf_sk_release
    - name: bpf_map_push_elem
    - name: bpf_map_pop_elem
    - name: bpf_map_peek_elem
    - name: bpf_msg_push_data
    - name: bpf_msg_pop_data
    - name: bpf_rc_pointer_rel
    - name: bpf_spin_lock
    - name: bpf_spin_unlock
    - name: bpf_sk_fullsock
    - name: bpf_tcp_sock
    - name: bpf_skb_ecn_set_ce
    - name: bpf_get_listener_sock
    - name: bpf_skc_lookup_tcp
    - name: bpf_tcp_check_syncookie
    - name: bpf_sysctl_get_name
    - name: bpf_sysctl_get_current_value
    - name: bpf_sysctl_get_new_value
    - name: bpf_sysctl_set_new_value
    - name: bpf_strtol
    - name: bpf_strtoul
    - name: bpf_sk_storage_get
    - name: bpf_sk_storage_delete
    - name: bpf_send_signal
    - name: bpf_tcp_gen_syncookie
    - name: bpf_skb_output
    - name: bpf_probe_read_user
    - name: bpf_probe_read_kernel
    - name: bpf_probe_read_user_str
    - name: bpf_probe_read_kernel_str
    - name: bpf_tcp_send_ack
    - name: bpf_send_signal_thread
    - name: bpf_jiffies64
    - name: bpf_read_branch_records
    - name: bpf_get_ns_current_pid_tgid
    - name: bpf_xdp_output
    - name: bpf_get_netns_cookie
    - name: bpf_get_current_ancestor_cgroup_id
    - name: bpf_sk_assign
    - name: bpf_ktime_get_boot_ns
    - name: bpf_seq_printf
    - name: bpf_seq_write
    - name: bpf_sk_cgroup_id
    - name: bpf_sk_ancestor_cgroup_id
    - name: bpf_ringbuf_output
    - name: bpf_ringbuf_reserve
    - name: bpf_ringbuf_submit
    - name: bpf_ringbuf_discard
    - name: bpf_ringbuf_query
    - name: bpf_csum_level
    - name: bpf_skc_to_tcp6_sock
    - name: bpf_skc_to_tcp_sock
    - name: bpf_skc_to_tcp_timewait_sock
    - name: bpf_skc_to_tcp_request_sock
    - name: bpf_skc_to_udp6_sock
    - name: bpf_get_task_stack
    - name: bpf_load_hdr_opt
    - name: bpf_store_hdr_opt
    - name: bpf_reserve_hdr_opt
    - name: bpf_inode_storage_get
    - name: bpf_inode_storage_delete
    - name: bpf_d_path
    - name: bpf_copy_from_user
    - name: bpf_snprintf_btf
    - name: bpf_seq_printf_btf
    - name: bpf_skb_cgroup_classid
    - name: bpf_redirect_neigh
    - name: bpf_per_cpu_ptr
    - name: bpf_this_cpu_ptr
    - name: bpf_redirect_peer
    - name: bpf_task_storage_get
    - name: bpf_task_storage_delete
    - name: bpf_get_current_task_btf
    - name: bpf_bprm_opts_set
    - name: bpf_ktime_get_coarse_ns
    - name: bpf_ima_inode_hash
    - name: bpf_sock_from_file
    - name: bpf_check_mtu
    - name: bpf_for_each_map_elem
    - name: bpf_snprintf
    - name: bpf_sys_bpf
    - name: bpf_btf_find_by_name_kind
    - name: bpf_sys_close
    - name: bpf_timer_init
    - name: bpf_timer_set_callback
    - name: bpf_timer_start
    - name: bpf_timer_cancel
    - name: bpf_get_func_ip
    - name: bpf_get_attach_cookie
    - name: bpf_task_pt_regs
    - name: bpf_get_branch_snapshot
    - name: bpf_trace_vprintk
    - name: bpf_skc_to_unix_sock
    - name: bpf_kallsyms_lookup_name
    - name: bpf_find_vma
    - name: bpf_loop
    - name: bpf_strncmp
    - name: bpf_get_func_arg
    - name: bpf_get_func_ret
    - name: bpf_get_func_arg_cnt
    - name: bpf_get_retval
    - name: bpf_set_retval
    - name: bpf_xdp_get_buff_len
    - name: bpf_xdp_load_bytes
    - name: bpf_xdp_store_bytes
    - name: bpf_copy_from_user_task
    - name: bpf_skb_set_tstamp
    - name: bpf_ima_file_hash
    - name: bpf_kptr_xchg
    - name: bpf_map_lookup_percpu_elem
    - name: bpf_skc_to_mptcp_sock
    - name: bpf_dynptr_from_mem
    - name: bpf_ringbuf_reserve_dynptr
    - name: bpf_ringbuf_submit_dynptr
    - name: bpf_ringbuf_discard_dynptr
    - name: bpf_dynptr_read
    - name: bpf_dynptr_write
    - name: bpf_dynptr_data
    - name: bpf_tcp_raw_gen_syncookie_ipv4
    - name: bpf_tcp_raw_gen_syncookie_ipv6
    - name: bpf_tcp_raw_check_syncookie_ipv4
    - name: bpf_tcp_raw_check_syncookie_ipv6
    - name: bpf_ktime_get_tai_ns
    - name: bpf_user_ringbuf_drain
    - name: bpf_cgrp_storage_get
    - name: bpf_cgrp_storage_delete
